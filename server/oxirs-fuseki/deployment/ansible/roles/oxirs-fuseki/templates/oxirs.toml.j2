# OxiRS Fuseki Configuration
# Generated by Ansible on {{ ansible_date_time.iso8601 }}
# Environment: {{ environment }}
# Hostname: {{ inventory_hostname }}

[server]
host = "0.0.0.0"
port = {{ oxirs_http_port }}
{% if enable_tls %}
tls_enabled = true
tls_port = {{ oxirs_https_port }}
tls_cert_path = "{{ oxirs_config_dir }}/server.crt"
tls_key_path = "{{ oxirs_config_dir }}/server.key"
{% endif %}
max_request_body_size = 104857600  # 100MB
request_timeout_secs = 300
graceful_shutdown_timeout_secs = 30
admin_ui_enabled = {{ 'true' if environment == 'development' else 'false' }}

[datasets]
base_path = "{{ oxirs_data_dir }}/datasets"
default_dataset = "default"
auto_create = true
persistent = true

[datasets.default]
storage = "tdb"
path = "{{ oxirs_data_dir }}/datasets/default"
description = "Default SPARQL dataset"

{% if enable_auth %}
[auth]
enabled = true
jwt_secret = "{{ jwt_secret | default('change-me-in-production') }}"
token_expiry_secs = 3600
refresh_token_expiry_secs = 604800  # 7 days

[auth.oauth2]
enabled = true
{% endif %}

{% if enable_metrics %}
[metrics]
enabled = true
prometheus_endpoint = "/metrics"
slow_query_threshold_ms = 1000
track_query_statistics = true
{% endif %}

[performance]
max_concurrent_queries = {{ max_threads | default(8) }}
query_timeout_secs = 300
result_cache_enabled = true
result_cache_size_mb = 512
connection_pool_size = 10

[logging]
level = "{{ log_level | default('info') }}"
format = "json"
output = "{{ oxirs_log_dir }}/oxirs-fuseki.log"

[features]
sparql_update = true
rdf_star = true
federation = true
{% if enable_clustering %}
clustering_enabled = true
{% endif %}
